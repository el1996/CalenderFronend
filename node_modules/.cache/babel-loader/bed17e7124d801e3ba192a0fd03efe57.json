{"ast":null,"code":"import _regeneratorRuntime from \"/Users/omarhmdea/Documents/calendar-front/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/omarhmdea/Documents/calendar-front/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _slicedToArray from \"/Users/omarhmdea/Documents/calendar-front/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nvar _jsxFileName = \"/Users/omarhmdea/Documents/calendar-front/src/context/AuthContext.js\",\n  _this = this,\n  _s = $RefreshSig$();\nimport { FOCUSABLE_SELECTOR } from \"@testing-library/user-event/dist/utils\";\nimport axios from \"axios\";\nimport { createContext, useEffect, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport AuthService from \"../services/AuthService\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport var AuthContext = /*#__PURE__*/createContext();\nexport var AuthContextProvider = function AuthContextProvider(_ref) {\n  _s();\n  var children = _ref.children;\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    currentUser = _useState2[0],\n    setCurrentUser = _useState2[1];\n  var _useState3 = useState(false),\n    _useState4 = _slicedToArray(_useState3, 2),\n    isAuth = _useState4[0],\n    setIsAuth = _useState4[1];\n  var _useState5 = useState({}),\n    _useState6 = _slicedToArray(_useState5, 2),\n    errors = _useState6[0],\n    setErrors = _useState6[1];\n  //const navigate = useNavigate();\n\n  var login = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(newUser) {\n      var result, _error$response;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            _context.next = 3;\n            return AuthService.loginViaEmail(newUser);\n          case 3:\n            result = _context.sent;\n            setCurrentUser(result.data.data);\n            setErrors({});\n            setIsAuth(true);\n            _context.next = 12;\n            break;\n          case 9:\n            _context.prev = 9;\n            _context.t0 = _context[\"catch\"](0);\n            setErrors(_context.t0 === null || _context.t0 === void 0 ? void 0 : (_error$response = _context.t0.response) === null || _error$response === void 0 ? void 0 : _error$response.data.errors);\n          case 12:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee, null, [[0, 9]]);\n    }));\n    return function login(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  var register = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(newUser) {\n      var result, _error$response2;\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.prev = 0;\n            _context2.next = 3;\n            return AuthService.register(newUser);\n          case 3:\n            result = _context2.sent;\n            setCurrentUser(result.data.data);\n            setErrors({});\n            _context2.next = 11;\n            break;\n          case 8:\n            _context2.prev = 8;\n            _context2.t0 = _context2[\"catch\"](0);\n            setErrors(_context2.t0 === null || _context2.t0 === void 0 ? void 0 : (_error$response2 = _context2.t0.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.data.errors);\n          case 11:\n          case \"end\":\n            return _context2.stop();\n        }\n      }, _callee2, null, [[0, 8]]);\n    }));\n    return function register(_x2) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  var logout = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n      return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n        while (1) switch (_context3.prev = _context3.next) {\n          case 0:\n            setCurrentUser(null);\n            setIsAuth(false);\n          case 2:\n          case \"end\":\n            return _context3.stop();\n        }\n      }, _callee3);\n    }));\n    return function logout() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n  useEffect(function () {\n    var user = window.sessionStorage.getItem(\"currentUser\");\n    if (user) {\n      user = JSON.parse(user);\n    }\n    setCurrentUser(user);\n    setIsAuth(window.sessionStorage.getItem(\"isAuth\") === \"true\");\n  }, []);\n  useEffect(function () {\n    window.sessionStorage.setItem(\"currentUser\", JSON.stringify(currentUser));\n    window.sessionStorage.setItem(\"isAuth\", isAuth);\n  }, [currentUser, isAuth]);\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      currentUser: currentUser,\n      setCurrentUser: setCurrentUser,\n      isAuth: isAuth,\n      setIsAuth: setIsAuth,\n      login: login,\n      logout: logout,\n      register: register,\n      errors: errors,\n      setErrors: setErrors\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 59,\n    columnNumber: 3\n  }, _this);\n};\n_s(AuthContextProvider, \"jjfdbq5NtiHwRjKP7rs1hxLL9HU=\");\n_c = AuthContextProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthContextProvider\");","map":{"version":3,"names":["FOCUSABLE_SELECTOR","axios","createContext","useEffect","useState","useNavigate","AuthService","AuthContext","AuthContextProvider","children","currentUser","setCurrentUser","isAuth","setIsAuth","errors","setErrors","login","newUser","loginViaEmail","result","data","response","register","logout","user","window","sessionStorage","getItem","JSON","parse","setItem","stringify"],"sources":["/Users/omarhmdea/Documents/calendar-front/src/context/AuthContext.js"],"sourcesContent":["import { FOCUSABLE_SELECTOR } from \"@testing-library/user-event/dist/utils\";\nimport axios from \"axios\";\nimport { createContext, useEffect, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport AuthService from \"../services/AuthService\";\n\nexport const AuthContext = createContext();\n\nexport const AuthContextProvider = ({ children }) => {\n\tconst [currentUser, setCurrentUser] = useState(null);\n\tconst [isAuth, setIsAuth] = useState(false);\n\tconst [errors, setErrors] = useState({});\n\t//const navigate = useNavigate();\n\n\tconst login = async (newUser) => {\n\t\ttry {\n\t\t\tconst result = await AuthService.loginViaEmail(newUser);\n\t\t\tsetCurrentUser(result.data.data);\n\t\t\tsetErrors({});\n\t\t\tsetIsAuth(true);\n\t\t} catch (error) {\n\t\t\tsetErrors(error?.response?.data.errors);\n\t\t}\n\t};\n\n\tconst register = async (newUser) => {\n\t\ttry {\n\t\t\tconst result = await AuthService.register(newUser);\n\t\t\tsetCurrentUser(result.data.data);\n\t\t\tsetErrors({});\n\t\t} catch (error) {\n\t\t\tsetErrors(error?.response?.data.errors);\n\t\t}\n\t};\n\n\tconst logout = async () => {\n\t\tsetCurrentUser(null);\n\t\tsetIsAuth(false);\n\t};\n\n\tuseEffect(() => {\n\t\tlet user = window.sessionStorage.getItem(\"currentUser\");\n\t\tif (user) {\n\t\t\tuser = JSON.parse(user);\n\t\t}\n\t\tsetCurrentUser(user);\n\t\tsetIsAuth(window.sessionStorage.getItem(\"isAuth\") === \"true\");\n\t}, []);\n\n\tuseEffect(() => {\n\t\twindow.sessionStorage.setItem(\n\t\t\t\"currentUser\",\n\t\t\tJSON.stringify(currentUser)\n\t\t);\n\t\twindow.sessionStorage.setItem(\"isAuth\", isAuth);\n\t}, [currentUser, isAuth]);\n\n\treturn (\n\t\t<AuthContext.Provider\n\t\t\tvalue={{\n\t\t\t\tcurrentUser,\n\t\t\t\tsetCurrentUser,\n\t\t\t\tisAuth,\n\t\t\t\tsetIsAuth,\n\t\t\t\tlogin,\n\t\t\t\tlogout,\n\t\t\t\tregister,\n\t\t\t\terrors,\n\t\t\t\tsetErrors,\n\t\t\t}}\n\t\t>\n\t\t\t{children}\n\t\t</AuthContext.Provider>\n\t);\n};\n"],"mappings":";;;;;;AAAA,SAASA,kBAAkB,QAAQ,wCAAwC;AAC3E,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,aAAa,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAC1D,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,OAAOC,WAAW,MAAM,yBAAyB;AAAC;AAElD,OAAO,IAAMC,WAAW,gBAAGL,aAAa,EAAE;AAE1C,OAAO,IAAMM,mBAAmB,GAAG,SAAtBA,mBAAmB,OAAqB;EAAA;EAAA,IAAfC,QAAQ,QAARA,QAAQ;EAC7C,gBAAsCL,QAAQ,CAAC,IAAI,CAAC;IAAA;IAA7CM,WAAW;IAAEC,cAAc;EAClC,iBAA4BP,QAAQ,CAAC,KAAK,CAAC;IAAA;IAApCQ,MAAM;IAAEC,SAAS;EACxB,iBAA4BT,QAAQ,CAAC,CAAC,CAAC,CAAC;IAAA;IAAjCU,MAAM;IAAEC,SAAS;EACxB;;EAEA,IAAMC,KAAK;IAAA,uEAAG,iBAAOC,OAAO;MAAA;MAAA;QAAA;UAAA;YAAA;YAAA;YAAA,OAELX,WAAW,CAACY,aAAa,CAACD,OAAO,CAAC;UAAA;YAAjDE,MAAM;YACZR,cAAc,CAACQ,MAAM,CAACC,IAAI,CAACA,IAAI,CAAC;YAChCL,SAAS,CAAC,CAAC,CAAC,CAAC;YACbF,SAAS,CAAC,IAAI,CAAC;YAAC;YAAA;UAAA;YAAA;YAAA;YAEhBE,SAAS,8EAAC,YAAOM,QAAQ,oDAAf,gBAAiBD,IAAI,CAACN,MAAM,CAAC;UAAC;UAAA;YAAA;QAAA;MAAA;IAAA,CAEzC;IAAA,gBATKE,KAAK;MAAA;IAAA;EAAA,GASV;EAED,IAAMM,QAAQ;IAAA,uEAAG,kBAAOL,OAAO;MAAA;MAAA;QAAA;UAAA;YAAA;YAAA;YAAA,OAERX,WAAW,CAACgB,QAAQ,CAACL,OAAO,CAAC;UAAA;YAA5CE,MAAM;YACZR,cAAc,CAACQ,MAAM,CAACC,IAAI,CAACA,IAAI,CAAC;YAChCL,SAAS,CAAC,CAAC,CAAC,CAAC;YAAC;YAAA;UAAA;YAAA;YAAA;YAEdA,SAAS,iFAAC,aAAOM,QAAQ,qDAAf,iBAAiBD,IAAI,CAACN,MAAM,CAAC;UAAC;UAAA;YAAA;QAAA;MAAA;IAAA,CAEzC;IAAA,gBARKQ,QAAQ;MAAA;IAAA;EAAA,GAQb;EAED,IAAMC,MAAM;IAAA,uEAAG;MAAA;QAAA;UAAA;YACdZ,cAAc,CAAC,IAAI,CAAC;YACpBE,SAAS,CAAC,KAAK,CAAC;UAAC;UAAA;YAAA;QAAA;MAAA;IAAA,CACjB;IAAA,gBAHKU,MAAM;MAAA;IAAA;EAAA,GAGX;EAEDpB,SAAS,CAAC,YAAM;IACf,IAAIqB,IAAI,GAAGC,MAAM,CAACC,cAAc,CAACC,OAAO,CAAC,aAAa,CAAC;IACvD,IAAIH,IAAI,EAAE;MACTA,IAAI,GAAGI,IAAI,CAACC,KAAK,CAACL,IAAI,CAAC;IACxB;IACAb,cAAc,CAACa,IAAI,CAAC;IACpBX,SAAS,CAACY,MAAM,CAACC,cAAc,CAACC,OAAO,CAAC,QAAQ,CAAC,KAAK,MAAM,CAAC;EAC9D,CAAC,EAAE,EAAE,CAAC;EAENxB,SAAS,CAAC,YAAM;IACfsB,MAAM,CAACC,cAAc,CAACI,OAAO,CAC5B,aAAa,EACbF,IAAI,CAACG,SAAS,CAACrB,WAAW,CAAC,CAC3B;IACDe,MAAM,CAACC,cAAc,CAACI,OAAO,CAAC,QAAQ,EAAElB,MAAM,CAAC;EAChD,CAAC,EAAE,CAACF,WAAW,EAAEE,MAAM,CAAC,CAAC;EAEzB,oBACC,QAAC,WAAW,CAAC,QAAQ;IACpB,KAAK,EAAE;MACNF,WAAW,EAAXA,WAAW;MACXC,cAAc,EAAdA,cAAc;MACdC,MAAM,EAANA,MAAM;MACNC,SAAS,EAATA,SAAS;MACTG,KAAK,EAALA,KAAK;MACLO,MAAM,EAANA,MAAM;MACND,QAAQ,EAARA,QAAQ;MACRR,MAAM,EAANA,MAAM;MACNC,SAAS,EAATA;IACD,CAAE;IAAA,UAEDN;EAAQ;IAAA;IAAA;IAAA;EAAA,SACa;AAEzB,CAAC;AAAC,GAlEWD,mBAAmB;AAAA,KAAnBA,mBAAmB;AAAA;AAAA"},"metadata":{},"sourceType":"module"}