{"ast":null,"code":"var _s = $RefreshSig$();\nimport React, { useContext, useEffect } from \"react\";\nimport { useSearchParams, useNavigate } from \"react-router-dom\";\nimport { serverAddress } from \"../constants\";\nimport { AuthContext } from \"../context/AuthContext\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function GitHubFetch() {\n  _s();\n  const [searchParams] = useSearchParams();\n  const navigate = useNavigate();\n  const {\n    setIsAuth,\n    setCurrentUser,\n    setErrors\n  } = useContext(AuthContext);\n  useEffect(() => {\n    let code = searchParams.get(\"code\");\n    let requestOptions = {\n      method: \"GET\",\n      redirect: \"follow\"\n    };\n    fetch(serverAddress + `/auth/login/github?code=${code}`, requestOptions).then(response => {\n      if (response.ok) {\n        response.json().then(resJson => {\n          //console.log(resJson?.data);\n          setCurrentUser(resJson === null || resJson === void 0 ? void 0 : resJson.data);\n          setErrors({});\n          setIsAuth(true);\n          // localStorage.setItem(\n          // \t\"user\",\n          // \tJSON.stringify(resJson.data.user)\n          // );\n          // localStorage.setItem(\"token\", resJson.data.token);\n          // setIsAuth(true);\n          navigate(\"/\");\n        });\n      } else {\n        response.json().then(resJson => alert(resJson.message));\n      }\n    }).catch(error => {\n      console.error(error);\n    });\n  }, []);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false);\n}\n_s(GitHubFetch, \"yDR8qPCC91TIa5q8CQKArUX7V+U=\", false, function () {\n  return [useSearchParams, useNavigate];\n});\n_c = GitHubFetch;\nvar _c;\n$RefreshReg$(_c, \"GitHubFetch\");","map":{"version":3,"names":["React","useContext","useEffect","useSearchParams","useNavigate","serverAddress","AuthContext","GitHubFetch","searchParams","navigate","setIsAuth","setCurrentUser","setErrors","code","get","requestOptions","method","redirect","fetch","then","response","ok","json","resJson","data","alert","message","catch","error","console"],"sources":["/Users/omarhmdea/Documents/calendar-front/src/components/GitHubFetch.js"],"sourcesContent":["import React, { useContext, useEffect } from \"react\";\nimport { useSearchParams, useNavigate } from \"react-router-dom\";\nimport { serverAddress } from \"../constants\";\nimport { AuthContext } from \"../context/AuthContext\";\nexport default function GitHubFetch() {\n\tconst [searchParams] = useSearchParams();\n\tconst navigate = useNavigate();\n\tconst { setIsAuth, setCurrentUser, setErrors } =\n\t\tuseContext(AuthContext);\n\n\tuseEffect(() => {\n\t\tlet code = searchParams.get(\"code\");\n\n\t\tlet requestOptions = {\n\t\t\tmethod: \"GET\",\n\t\t\tredirect: \"follow\",\n\t\t};\n\t\tfetch(\n\t\t\tserverAddress + `/auth/login/github?code=${code}`,\n\t\t\trequestOptions\n\t\t)\n\t\t\t.then((response) => {\n\t\t\t\tif (response.ok) {\n\t\t\t\t\tresponse.json().then((resJson) => {\n\t\t\t\t\t\t//console.log(resJson?.data);\n\t\t\t\t\t\tsetCurrentUser(resJson?.data);\n\t\t\t\t\t\tsetErrors({});\n\t\t\t\t\t\tsetIsAuth(true);\n\t\t\t\t\t\t// localStorage.setItem(\n\t\t\t\t\t\t// \t\"user\",\n\t\t\t\t\t\t// \tJSON.stringify(resJson.data.user)\n\t\t\t\t\t\t// );\n\t\t\t\t\t\t// localStorage.setItem(\"token\", resJson.data.token);\n\t\t\t\t\t\t// setIsAuth(true);\n\t\t\t\t\t\tnavigate(\"/\");\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tresponse.json().then((resJson) => alert(resJson.message));\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tconsole.error(error);\n\t\t\t});\n\t}, []);\n\n\treturn <></>;\n}\n"],"mappings":";AAAA,OAAOA,KAAK,IAAIC,UAAU,EAAEC,SAAS,QAAQ,OAAO;AACpD,SAASC,eAAe,EAAEC,WAAW,QAAQ,kBAAkB;AAC/D,SAASC,aAAa,QAAQ,cAAc;AAC5C,SAASC,WAAW,QAAQ,wBAAwB;AAAC;AAAA;AACrD,eAAe,SAASC,WAAW,GAAG;EAAA;EACrC,MAAM,CAACC,YAAY,CAAC,GAAGL,eAAe,EAAE;EACxC,MAAMM,QAAQ,GAAGL,WAAW,EAAE;EAC9B,MAAM;IAAEM,SAAS;IAAEC,cAAc;IAAEC;EAAU,CAAC,GAC7CX,UAAU,CAACK,WAAW,CAAC;EAExBJ,SAAS,CAAC,MAAM;IACf,IAAIW,IAAI,GAAGL,YAAY,CAACM,GAAG,CAAC,MAAM,CAAC;IAEnC,IAAIC,cAAc,GAAG;MACpBC,MAAM,EAAE,KAAK;MACbC,QAAQ,EAAE;IACX,CAAC;IACDC,KAAK,CACJb,aAAa,GAAI,2BAA0BQ,IAAK,EAAC,EACjDE,cAAc,CACd,CACCI,IAAI,CAAEC,QAAQ,IAAK;MACnB,IAAIA,QAAQ,CAACC,EAAE,EAAE;QAChBD,QAAQ,CAACE,IAAI,EAAE,CAACH,IAAI,CAAEI,OAAO,IAAK;UACjC;UACAZ,cAAc,CAACY,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEC,IAAI,CAAC;UAC7BZ,SAAS,CAAC,CAAC,CAAC,CAAC;UACbF,SAAS,CAAC,IAAI,CAAC;UACf;UACA;UACA;UACA;UACA;UACA;UACAD,QAAQ,CAAC,GAAG,CAAC;QACd,CAAC,CAAC;MACH,CAAC,MAAM;QACNW,QAAQ,CAACE,IAAI,EAAE,CAACH,IAAI,CAAEI,OAAO,IAAKE,KAAK,CAACF,OAAO,CAACG,OAAO,CAAC,CAAC;MAC1D;IACD,CAAC,CAAC,CACDC,KAAK,CAAEC,KAAK,IAAK;MACjBC,OAAO,CAACD,KAAK,CAACA,KAAK,CAAC;IACrB,CAAC,CAAC;EACJ,CAAC,EAAE,EAAE,CAAC;EAEN,oBAAO,qCAAK;AACb;AAAC,GA1CuBrB,WAAW;EAAA,QACXJ,eAAe,EACrBC,WAAW;AAAA;AAAA,KAFLG,WAAW;AAAA;AAAA"},"metadata":{},"sourceType":"module"}